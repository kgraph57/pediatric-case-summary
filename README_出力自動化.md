# 出力自動化の使い方

## 🚀 クイックスタート

### 方法1: AIに直接依頼（最も簡単・推奨）

```
以下の症例要約を、ルールに完全準拠したWord形式（.docx）で出力してください。

【出力要件】
- フォント: MS明朝（和文）、Times New Roman（欧文）
- 文字サイズ: 11pt
- 30行以内に収める
- 各項目（【主訴】など）の冒頭でのみ改行
- 数字はすべて半角
- 単位のスペースはルールに従う

【症例要約テキスト】
[ここにAIが作成した症例要約を貼り付け]
```

**→ AIが自動でWordファイルを生成**

---

### 方法2: Pythonスクリプトを使用

#### 1. 必要なライブラリをインストール

```bash
pip install python-docx
```

#### 2. 症例データをJSON形式で準備

`example_case.json` を参考に、症例データをJSON形式で作成。

#### 3. スクリプトを実行

```bash
# 単一症例を出力
python word_output_generator.py example_case.json

# 複数症例を一括出力
python word_output_generator.py cases.json --all
```

---

## 📝 JSON形式の例

```json
{
  "case_number": 1,
  "is_designated_disease": true,
  "field_number": 3,
  "patient_id": "P12345",
  "is_inpatient": true,
  "care_period": "2024年4月1日～2024年4月15日",
  "age": "生後2か月",
  "gender": "male",
  "outcome": "治癒",
  "chief_complaint": "発熱と咳嗽で来院",
  "present_illness": "現病歴の内容...",
  "physical_examination": "診察所見の内容...",
  "laboratory_findings": "検査所見の内容...",
  "differential_diagnoses": ["鑑別診断1", "鑑別診断2"],
  "problem_points": "症例の問題点",
  "hospital_course": "入院後経過...",
  "family_explanation": "家族への説明...",
  "post_discharge_course": "退院後の経過..."
}
```

---

## 🎯 推奨ワークフロー

### Step 1: AIに症例要約を作成してもらう
```
症例番号1、分野番号3、指定疾患ありです。
以下の情報から症例要約を作成してください。

[カルテから抜き出した情報を貼り付け]
```

### Step 2: AIにWord形式で出力してもらう
```
上記の症例要約を、ルールに完全準拠したWord形式（.docx）で出力してください。
```

### Step 3: 生成されたWordファイルを確認
- フォントが統一されているか
- 文字サイズが適切か（11pt）
- 30行以内に収まっているか
- レイアウトが適切か

---

## ✅ 出力ファイルの確認項目

### 自動チェック（AI/スクリプトが行う）
- ✅ フォントが統一されているか（MS明朝、Times New Roman）
- ✅ 文字サイズが適切か（10.5pt～12pt）
- ✅ 数字がすべて半角か
- ✅ 単位のスペースが正しいか
- ✅ 句読点が、。で統一されているか
- ✅ 30行以内に収まっているか
- ✅ 各項目の冒頭でのみ改行されているか

### ユーザーが確認すること
- ✅ 医学的内容が正確か
- ✅ 数値が正しいか
- ✅ 診断名が正しいか

---

## 💡 よくある質問

### Q: Wordファイルが生成されない
A: Cursorの場合は、AIに「ファイルを生成してください」と明示的に依頼してください。

### Q: フォントが正しく表示されない
A: MS明朝がインストールされていない場合、システムのデフォルトフォントが使用されます。MS明朝をインストールしてください。

### Q: 複数症例を一括で出力したい
A: すべての症例要約テキストをまとめて送り、「全30症例を1つのWordファイルにまとめて出力してください」と依頼してください。

---

## 📚 関連ファイル

- `AI支援執筆ワークフロー.md` - 全体のワークフロー
- `出力自動化ガイド.md` - 詳細な出力方法
- `word_output_generator.py` - Pythonスクリプト
- `example_case.json` - JSON形式の例

---

**この方法で、出力も完全自動化され、手動調整が一切不要になります！**
