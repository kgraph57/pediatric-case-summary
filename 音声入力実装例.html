<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç—‡ä¾‹è¦ç´„ä½œæˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ - éŸ³å£°å…¥åŠ›ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .voice-input-area {
            background: #f8f9fa;
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .voice-input-area:hover {
            background: #f0f0f0;
            border-color: #764ba2;
        }

        .voice-input-area.recording {
            background: #fff3cd;
            border-color: #ffc107;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .mic-icon {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .voice-input-text {
            min-height: 200px;
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            margin: 20px 0;
        }

        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .button:active {
            transform: translateY(0);
        }

        .button.secondary {
            background: #6c757d;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #0c5460;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #155724;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #721c24;
        }

        .status.processing {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s;
        }

        .result-area {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            display: none;
        }

        .result-area h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .result-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            white-space: pre-wrap;
            font-family: 'MS Mincho', serif;
            font-size: 11pt;
            line-height: 1.6;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 20px;
            }

            .voice-input-area {
                padding: 30px 20px;
            }

            .mic-icon {
                font-size: 48px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤ ç—‡ä¾‹è¦ç´„ä½œæˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</h1>
        <p class="subtitle">éŸ³å£°å…¥åŠ›ã§ç—‡ä¾‹è¦ç´„ã‚’è‡ªå‹•ç”Ÿæˆ</p>

        <form id="caseForm">
            <div class="form-group">
                <label>ç—‡ä¾‹ç•ªå·</label>
                <input type="number" id="caseNumber" value="1" required>
            </div>

            <div class="form-group">
                <label>åˆ†é‡ç•ªå·</label>
                <select id="fieldNumber" required>
                    <option value="1">åˆ†é‡1</option>
                    <option value="2">åˆ†é‡2</option>
                    <option value="3" selected>åˆ†é‡3</option>
                    <option value="4">åˆ†é‡4</option>
                    <option value="5">åˆ†é‡5</option>
                    <option value="6">åˆ†é‡6</option>
                    <option value="7">åˆ†é‡7</option>
                    <option value="8">åˆ†é‡8</option>
                    <option value="9">åˆ†é‡9</option>
                    <option value="10">åˆ†é‡10</option>
                </select>
            </div>

            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="isDesignatedDisease" class="checkbox">
                    <label for="isDesignatedDisease" style="display: inline; margin: 0;">æŒ‡å®šç–¾æ‚£</label>
                </div>
            </div>

            <div class="voice-input-area" id="voiceInputArea">
                <div class="mic-icon">ğŸ¤</div>
                <h3>ã‚¿ãƒƒãƒ—ã—ã¦è©±ã—ã¦ãã ã•ã„</h3>
                <p style="color: #666; margin-top: 10px;">ã‚«ãƒ«ãƒ†ã‚’è¦‹ãªãŒã‚‰ã€æ€ã„ã¤ã„ãŸé †ã§è©±ã—ã¦ãã ã•ã„</p>
                <p style="color: #999; font-size: 12px; margin-top: 5px;">å½¢å¼ã¯æ°—ã«ã—ãªãã¦OKã§ã™</p>
            </div>

            <textarea 
                id="voiceInputText" 
                class="voice-input-text" 
                placeholder="éŸ³å£°å…¥åŠ›ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚æ‰‹å‹•ã§å…¥åŠ›ãƒ»ç·¨é›†ã‚‚å¯èƒ½ã§ã™ã€‚"
            ></textarea>

            <div id="status" class="status"></div>

            <button type="button" id="startRecording" class="button">
                ğŸ¤ éŸ³å£°å…¥åŠ›ã‚’é–‹å§‹
            </button>

            <button type="button" id="stopRecording" class="button secondary" style="display: none;">
                â¹ï¸ éŸ³å£°å…¥åŠ›ã‚’åœæ­¢
            </button>

            <button type="submit" id="submitButton" class="button">
                ğŸ“¤ ç—‡ä¾‹è¦ç´„ã‚’ä½œæˆ
            </button>
        </form>

        <div id="resultArea" class="result-area">
            <h3>âœ… ç—‡ä¾‹è¦ç´„ãŒå®Œæˆã—ã¾ã—ãŸ</h3>
            <div id="resultContent" class="result-content"></div>
            <button id="downloadWord" class="button" style="margin-top: 15px;">
                ğŸ“„ Wordå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            </button>
        </div>
    </div>

    <script>
        const voiceInputArea = document.getElementById('voiceInputArea');
        const voiceInputText = document.getElementById('voiceInputText');
        const startRecordingBtn = document.getElementById('startRecording');
        const stopRecordingBtn = document.getElementById('stopRecording');
        const submitButton = document.getElementById('submitButton');
        const statusDiv = document.getElementById('status');
        const resultArea = document.getElementById('resultArea');
        const resultContent = document.getElementById('resultContent');
        const downloadWordBtn = document.getElementById('downloadWord');

        let recognition = null;
        let isRecording = false;

        // Web Speech APIã®åˆæœŸåŒ–
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'ja-JP';
            recognition.continuous = true;
            recognition.interimResults = true;

            recognition.onstart = () => {
                isRecording = true;
                voiceInputArea.classList.add('recording');
                startRecordingBtn.style.display = 'none';
                stopRecordingBtn.style.display = 'block';
                showStatus('ğŸ¤ éŸ³å£°èªè­˜ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚è©±ã—ã¦ãã ã•ã„...', 'info');
            };

            recognition.onresult = (event) => {
                let interimTranscript = '';
                let finalTranscript = '';

                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }

                voiceInputText.value = finalTranscript + interimTranscript;
            };

            recognition.onerror = (event) => {
                console.error('éŸ³å£°èªè­˜ã‚¨ãƒ©ãƒ¼:', event.error);
                showStatus('âŒ éŸ³å£°èªè­˜ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚', 'error');
                stopRecording();
            };

            recognition.onend = () => {
                stopRecording();
            };
        } else {
            showStatus('âš ï¸ ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°èªè­˜ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚', 'error');
            startRecordingBtn.style.display = 'none';
        }

        startRecordingBtn.addEventListener('click', () => {
            if (recognition) {
                recognition.start();
            }
        });

        stopRecordingBtn.addEventListener('click', () => {
            if (recognition) {
                recognition.stop();
            }
        });

        voiceInputArea.addEventListener('click', () => {
            if (!isRecording && recognition) {
                recognition.start();
            }
        });

        function stopRecording() {
            isRecording = false;
            voiceInputArea.classList.remove('recording');
            startRecordingBtn.style.display = 'block';
            stopRecordingBtn.style.display = 'none';
        }

        function showStatus(message, type) {
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }

        document.getElementById('caseForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const caseNumber = document.getElementById('caseNumber').value;
            const fieldNumber = document.getElementById('fieldNumber').value;
            const isDesignatedDisease = document.getElementById('isDesignatedDisease').checked;
            const voiceText = voiceInputText.value.trim();

            if (!voiceText) {
                showStatus('âŒ éŸ³å£°å…¥åŠ›ã¾ãŸã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', 'error');
                return;
            }

            showStatus('ğŸ¤– AIãŒæƒ…å ±ã‚’æ•´ç†ä¸­...', 'processing');
            submitButton.disabled = true;

            try {
                // ã“ã“ã§AI APIã‚’å‘¼ã³å‡ºã™
                // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€OpenAI APIã‚„Anthropic APIã‚’ä½¿ç”¨
                const prompt = `ä»¥ä¸‹ã®éŸ³å£°å…¥åŠ›ã‹ã‚‰ç—‡ä¾‹è¦ç´„ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ç—‡ä¾‹ç•ªå·: ${caseNumber}
åˆ†é‡ç•ªå·: ${fieldNumber}
æŒ‡å®šç–¾æ‚£: ${isDesignatedDisease ? 'ã‚ã‚Š' : 'ãªã—'}

ã€éŸ³å£°å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã€‘
${voiceText}

ã€è¦ä»¶ã€‘
1. éŸ³å£°å…¥åŠ›ã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡ºãƒ»åˆ†é¡ã—ã¦ãã ã•ã„
2. ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦ç—‡ä¾‹è¦ç´„ã‚’ä½œæˆã—ã¦ãã ã•ã„
3. 30è¡Œä»¥å†…ã«åã‚ã¦ãã ã•ã„
4. è¡¨è¨˜ãƒ«ãƒ¼ãƒ«ã‚’éµå®ˆã—ã¦ãã ã•ã„`;

                // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã“ã“ã§AI APIã‚’å‘¼ã³å‡ºã™
                // const response = await callAIAPI(prompt);
                
                // ãƒ‡ãƒ¢ç”¨ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹
                const demoResponse = `ç—‡ä¾‹ç•ªå·: ${caseNumber}${isDesignatedDisease ? ' â—‹' : ''}
åˆ†é‡ç•ªå·: ${fieldNumber}
æ‚£è€…ID: [æŠ½å‡ºã•ã‚ŒãŸID]
å…¥é™¢ãƒ»å¤–æ¥: [æŠ½å‡ºã•ã‚ŒãŸæƒ…å ±]
å—ã‘æŒã¡æœŸé–“: [æŠ½å‡ºã•ã‚ŒãŸæœŸé–“]
å¹´é½¢: [æŠ½å‡ºã•ã‚ŒãŸå¹´é½¢]
æ€§åˆ¥: [æŠ½å‡ºã•ã‚ŒãŸæ€§åˆ¥]
è»¢å¸°: [æŠ½å‡ºã•ã‚ŒãŸè»¢å¸°]

ã€ä¸»è¨´ã€‘
[æŠ½å‡ºã•ã‚ŒãŸä¸»è¨´]

ã€ç¾ç—…æ­´ã€‘
[æŠ½å‡ºã•ã‚ŒãŸç¾ç—…æ­´]

ã€å…¥é™¢æ™‚è¨ºå¯Ÿæ‰€è¦‹ã€‘
[æŠ½å‡ºã•ã‚ŒãŸè¨ºå¯Ÿæ‰€è¦‹]

ã€å…¥é™¢æ™‚æ¤œæŸ»æ‰€è¦‹ã€‘
[æŠ½å‡ºã•ã‚ŒãŸæ¤œæŸ»æ‰€è¦‹]

ã€é‘‘åˆ¥è¨ºæ–­ã€‘
1. [æŠ½å‡ºã•ã‚ŒãŸé‘‘åˆ¥è¨ºæ–­1]
2. [æŠ½å‡ºã•ã‚ŒãŸé‘‘åˆ¥è¨ºæ–­2]

ã€å…¥é™¢å¾ŒçµŒéã€‘
[æŠ½å‡ºã•ã‚ŒãŸçµŒé]

ã€å®¶æ—ã¸ã®èª¬æ˜ãƒ»æŒ‡ç¤ºã€‘
[æŠ½å‡ºã•ã‚ŒãŸèª¬æ˜å†…å®¹]`;

                showStatus('âœ… ç—‡ä¾‹è¦ç´„ãŒå®Œæˆã—ã¾ã—ãŸï¼', 'success');
                resultContent.textContent = demoResponse;
                resultArea.style.display = 'block';
                resultArea.scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼:', error);
                showStatus('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚', 'error');
            } finally {
                submitButton.disabled = false;
            }
        });

        downloadWordBtn.addEventListener('click', () => {
            showStatus('ğŸ“„ Wordãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆä¸­...', 'processing');
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€Wordãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            // ã“ã“ã§ã¯ãƒ‡ãƒ¢ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            setTimeout(() => {
                showStatus('âœ… Wordãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚', 'success');
            }, 1000);
        });
    </script>
</body>
</html>
